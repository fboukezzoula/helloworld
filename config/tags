#!/bin/bash

# Variables Netbox
API_TOKEN="ton_token_ici"
NETBOX_URL="https://ton.netbox/api"

# Tableau de tags Ã  chercher
TAGS=("EUN" "EUW" "FRC")

# Boucle sur chaque tag
for TAG in "${TAGS[@]}"; do
    echo "ğŸ” Recherche du tag: $TAG"

    # RequÃªte pour obtenir l'ID du tag
    TAG_ID=$(curl -s -H "Authorization: Token $API_TOKEN" \
        "$NETBOX_URL/extras/tags/?name=$TAG" | jq -r '.results[0].id')

    # VÃ©rification que l'ID est bien rÃ©cupÃ©rÃ©
    if [[ -z "$TAG_ID" || "$TAG_ID" == "null" ]]; then
        echo "âŒ Ã‰chec pour trouver l'ID du tag: $TAG"
        exit 1
    fi

    # DÃ©finir dynamiquement la variable : ex. EUN_id=7
    declare "${TAG}_id=$TAG_ID"
    echo "âœ… $TAG_id = ${!TAG_id}"
done

# Exemple d'utilisation : accÃ©der Ã  EUN_id
echo "ğŸ‘‰ ID de EUN: $EUN_id"
echo "ğŸ‘‰ ID de EUW: $EUW_id"
echo "ğŸ‘‰ ID de FRC: $FRC_id"
